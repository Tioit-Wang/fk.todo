# UI 调整（1~6）测试用例清单（需求覆盖 100%）

> 目标：覆盖本轮 6 条 UI/交互需求的验收路径，避免回归。
>
> 范围：
> 1) 批量只在列表，四象限不允许批量迁移  
> 2) 今日焦点页面仅用于选择焦点（仅未完成）  
> 3) TaskCard 展开按钮在最后  
> 4) TaskCard 收起态显示前 3 个步骤（更紧凑）  
> 5) 所有确认弹窗使用自定义组件  
> 6) 所有通知提示使用自定义组件（Toast/弹窗）

## 0) 测试准备

- 启动：`cd todo-tool && npm run tauri dev`
- 准备数据：
  - 至少 6 条未完成任务，分布在不同象限（Q1~Q4）。
  - 至少 2 条任务含 steps（其中 1 条 steps >= 4）。
  - 至少 1 条循环任务（repeat != none），并能被完成/取消完成。

## 1) 批量只在列表，四象限不允许批量迁移

步骤：
1. 打开主界面（main），切到「列表」视图。
2. 点击「批量」，勾选 2 条任务。
3. 切换到「四象限」视图。

期望：
- 切换到四象限后：自动退出批量模式；已选任务清空。
- 四象限任务卡片不出现批量 checkbox/选择态。
- UI 中不存在「批量移动象限」入口（避免跨象限误操作）。

回归点：
- 回到「列表」视图后，批量仍为关闭状态（不会残留）。

## 2) 今日焦点页面仅用于选择焦点（仅未完成）

步骤：
1. 在主界面点击日历按钮进入 `#/main/today`。
2. 观察页面内容结构。
3. 确认「已完成任务」不会出现在候选列表中。
4. 使用搜索框输入关键字，确认候选列表过滤生效。
5. 依次选择 4 条不同任务。
6. 点击「保存焦点」，返回主界面，再次进入今日焦点页。

期望：
- 页面只包含：焦点选择工具栏 + 搜索 + 候选列表（不显示其他分组/不显示 TaskComposer/不展示逾期/今日到期等列表）。
- 候选列表仅包含未完成任务。
- 最多可选 3 个；第 4 个无法选中且有提示文案（limit）。
- 保存后再次进入：当日焦点选择状态保持一致（持久化正确）。

## 3) TaskCard 展开按钮在最后

步骤：
1. 在主界面列表中找到任意任务卡片。
2. 观察右侧 action 区按钮排列顺序。

期望：
- 展开/收起按钮位于最右侧（最后一个 action）。
- 展开/收起不会被其他按钮挤到前面（避免误点）。

## 4) TaskCard 收起态显示前 3 个步骤（更紧凑）

步骤：
1. 选择一条包含 steps 的任务，并保持卡片处于收起态。
2. 若存在 steps >= 4 的任务，观察显示。

期望：
- 收起态下显示 steps 预览（最多 3 条）。
- 每条 step 显示完成标记（如 `[ ]` / `[x]`）与标题；间距紧凑。
- steps 超过 3 条时显示 `... (+N)` 提示。

## 5) 所有确认弹窗使用自定义组件（不使用原生 confirm）

步骤（至少覆盖以下 3 类）：
1. 删除任务：点击任务卡片「删除」。
2. 设置页恢复/删除备份：进入设置页，点击「恢复」或「删除」备份。
3. 循环任务取消完成：完成一条循环任务后，点击取消完成。

期望：
- 以上所有确认都出现统一样式的自定义弹窗（`ConfirmDialog`）。
- 不出现浏览器原生 confirm 弹框。
- 键盘交互可用：`Enter` 确认、`Escape` 取消/关闭。

## 6) 所有通知提示使用自定义组件（不使用原生 alert）

步骤（至少覆盖以下 2 类）：
1. 设置页：导出后点击「复制路径」。
2. 设置页：把快捷键设置为非法值并返回（触发错误提示）。

期望：
- 复制成功：出现 Toast 成功提示。
- 复制失败（如果运行环境不允许 clipboard）：出现自定义弹窗显示路径（而不是原生 alert）。
- 快捷键非法：出现 Toast 错误提示（而不是原生 alert）。

## 自动化回归（已加入的守卫用例）

- `npm test`
  - 包含 `todo-tool/tests/no-native-dialogs.test.ts`：确保 `todo-tool/src/` 中不存在 `alert(`/`confirm(`（防止回归到原生弹窗）。

